<!doctype html>
<html lang="es">
<head>
  <link rel="stylesheet" href="styles.css">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RODES | Audi Q5 Progressive</title>
</head>

<body class="page-details">

  <!-- HERO con carrusel (sin textos) -->
  <header class="hero hero--details">
    <div class="hero-carousel" data-carousel="hero">
      <button class="hero-arrow hero-arrow--left" type="button" aria-label="Imagen anterior">‹</button>

      <div class="hero-track" id="heroTrackProgressive" aria-label="Galería del auto">
        <!-- ✅ PON AQUÍ LAS URLs de tus imágenes (pueden ser links o rutas locales) -->
        <div class="hero-slide"><img src="images/audi-1.jpg" alt="Audi Q5 Progressive - Foto 1"></div>
        <div class="hero-slide"><img src="images/audi-2.jpg" alt="Audi Q5 Progressive - Foto 2"></div>
        <div class="hero-slide"><img src="images/audi-3.jpg" alt="Audi Q5 Progressive - Foto 3"></div>
        <div class="hero-slide"><img src="images/audi-4.jpg" alt="Audi Q5 Progressive - Foto 3"></div>
      </div>

      <button class="hero-arrow hero-arrow--right" type="button" aria-label="Imagen siguiente">›</button>

      <!-- Indicadores -->
      <div class="hero-indicators">
        <div class="hero-hint">Desliza ← →</div>
        <div class="hero-count" id="heroCountProgressive">1 / 3</div>
        <div class="hero-dots" id="heroDotsProgressive" aria-label="Indicador de imágenes"></div>
      </div>

      <!-- Botones (mantiene header consistente con el resto) -->
      <nav class="hero-nav">
        <a class="glass-btn" href="index.html">Inicio</a>
        <a class="glass-btn" href="q5progressive.html">Reservar</a>
        <a class="glass-btn" href="contacto.html">Contacto</a>
      </nav>
    </div>
  </header>

  <main class="main">
    <section class="section container">
      <!-- Cuadrante central semitransparente (lo mantenemos) -->
      <div class="details-card">
        <h2 class="details-title">Características principales</h2>

        <div class="details-grid">
          <div class="details-item">Motor: 2.0T Quattro</div>
          <div class="details-item">Transmisión: Automática</div>
          <div class="details-item">Capacidad: 5 pasajeros</div>
          <div class="details-item">Maletero amplio</div>
          <div class="details-item">Pantalla digital</div>
          <div class="details-item">Apple CarPlay / Android Auto</div>
        </div>

        <h3 class="details-subtitle">Incluye</h3>
        <ul class="details-list">
          <li>Aire acondicionado</li>
          <li>Bluetooth</li>
          <li>Cámara trasera</li>
          <li>Sensores de parqueo</li>
        </ul>

        <div class="details-actions">
          <a class="btn btn-ghost" href="index.html">Volver</a>
          <a class="btn btn-primary" href="q5progressive.html">Reservar este auto</a>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Carrusel infinito (touch + flechas + dots + contador)
    function initInfiniteHeroCarousel(trackId, dotsId, countId) {
      const track = document.getElementById(trackId);
      const dotsWrap = document.getElementById(dotsId);
      const countEl = document.getElementById(countId);
      if (!track || !dotsWrap || !countEl) return;

      const carouselRoot = track.closest(".hero-carousel");
      const btnPrev = carouselRoot?.querySelector(".hero-arrow--left");
      const btnNext = carouselRoot?.querySelector(".hero-arrow--right");

      // Slides reales
      const realSlides = Array.from(track.querySelectorAll(".hero-slide"));
      const n = realSlides.length;
      if (n <= 0) return;

      // Clonar para loop infinito (1 al inicio y 1 al final)
      const firstClone = realSlides[0].cloneNode(true);
      const lastClone = realSlides[n - 1].cloneNode(true);

      firstClone.setAttribute("data-clone", "1");
      lastClone.setAttribute("data-clone", "1");

      track.insertBefore(lastClone, realSlides[0]);
      track.appendChild(firstClone);

      // Dots
      dotsWrap.innerHTML = "";
      for (let i = 0; i < n; i++) {
        const d = document.createElement("button");
        d.type = "button";
        d.className = "hero-dot" + (i === 0 ? " active" : "");
        d.setAttribute("aria-label", "Ir a imagen " + (i + 1));
        d.addEventListener("click", () => scrollToReal(i + 1));
        dotsWrap.appendChild(d);
      }

      // Helpers
      function slideWidth() {
        return track.clientWidth || 1;
      }

      // Real index: 1..n (porque 0 es clone last, n+1 es clone first)
      let current = 1;

      function updateUI() {
        const realIndex = ((current - 1 + n) % n) + 1; // 1..n
        countEl.textContent = realIndex + " / " + n;

        const dots = dotsWrap.querySelectorAll(".hero-dot");
        dots.forEach((dot, idx) => dot.classList.toggle("active", idx === (realIndex - 1)));
      }

      function jumpTo(index) {
        current = index;
        track.scrollLeft = current * slideWidth();
        updateUI();
      }

      function scrollTo(index) {
        current = index;
        track.scrollTo({ left: current * slideWidth(), behavior: "smooth" });
        updateUI();
      }

      function scrollToReal(realIndex1toN) {
        // convertir a index interno (1..n)
        scrollTo(realIndex1toN);
      }

      // Inicial: mostrar la primera real (index interno 1)
      // Hacerlo en el próximo frame para asegurar layout
      requestAnimationFrame(() => jumpTo(1));

      // Flechas
      btnPrev?.addEventListener("click", () => scrollTo(current - 1));
      btnNext?.addEventListener("click", () => scrollTo(current + 1));

      // “Snap end” + loop handling
      let t = null;
      track.addEventListener("scroll", () => {
        clearTimeout(t);
        t = setTimeout(() => {
          const w = slideWidth();
          const idx = Math.round(track.scrollLeft / w);
          current = idx;

          // Si cayó en clones, saltar sin animación
          if (current === 0) {
            // clone del último → saltar al último real (n)
            jumpTo(n);
            return;
          }
          if (current === n + 1) {
            // clone del primero → saltar al primer real (1)
            jumpTo(1);
            return;
          }
          updateUI();
        }, 90);
      });

      // Resize: mantener la misma slide visible
      window.addEventListener("resize", () => {
        jumpTo(current);
      });
    }

    initInfiniteHeroCarousel("heroTrackProgressive", "heroDotsProgressive", "heroCountProgressive");
  </script>

</body>
</html>
